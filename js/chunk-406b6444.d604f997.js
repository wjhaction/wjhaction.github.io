(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-406b6444"],{"3ba3":function(e,t,r){},"5a0f":function(e,t,r){"use strict";r.d(t,"d",(function(){return o})),r.d(t,"f",(function(){return s})),r.d(t,"b",(function(){return i})),r.d(t,"e",(function(){return a})),r.d(t,"c",(function(){return n})),r.d(t,"h",(function(){return c})),r.d(t,"a",(function(){return d})),r.d(t,"g",(function(){return u}));var l=r("1bab");function o(e){return Object(l["a"])({url:"rights/"+e})}function s(e){return Object(l["a"])({url:"/roles"})}function i(e){return Object(l["a"])({url:"/roles",method:"post",data:{...e}})}function a(e){return Object(l["a"])({url:"roles/"+e})}function n(e){return Object(l["a"])({url:"roles/"+e.roleId,method:"put",data:{roleName:e.roleName,roleDesc:e.roleDesc}})}function c(e){return Object(l["a"])({url:"roles/"+e,method:"delete"})}function d(e,t){return Object(l["a"])({url:`roles/${e}/rights`,method:"post",data:{rids:t}})}function u(e,t){return Object(l["a"])({url:`roles/${e}/rights/${t}`,method:"delete"})}},"6cd8":function(e,t,r){"use strict";r("9d60")},"9d60":function(e,t,r){},ae71:function(e,t,r){"use strict";var l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._t("firstMenu",[e._v("一级菜单")])],2),r("el-breadcrumb-item",[e._t("secondMenu",[e._v("二级菜单")])],2)],1)},o=[],s={name:"BreadcrumbNav"},i=s,a=r("2877"),n=Object(a["a"])(i,l,o,!1,null,"2d65e998",null);t["a"]=n.exports},ba86:function(e,t,r){},c692:function(e,t,r){"use strict";r("ba86")},de2c:function(e,t,r){"use strict";r("3ba3")},dec3:function(e,t,r){"use strict";r.r(t);var l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("breadcrumb-nav",{scopedSlots:e._u([{key:"firstMenu",fn:function(){return[e._v("权限管理")]},proxy:!0},{key:"secondMenu",fn:function(){return[e._v("角色列表")]},proxy:!0}])}),r("el-card",[r("role-add",{on:{"role-list":e.updateRoleList}}),r("role-table",{attrs:{"roles-list":e.rolesList},on:{"role-list":e.updateRoleList}})],1)],1)},o=[],s=r("ae71"),i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",[r("el-col",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("添加角色")])],1)],1),r("el-dialog",{attrs:{title:"添加用户",visible:e.addDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addDialogClose}},[r("el-form",{ref:"addRoleFormRef",attrs:{model:e.addRoleForm,rules:e.roleFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[r("el-input",{model:{value:e.addRoleForm.roleName,callback:function(t){e.$set(e.addRoleForm,"roleName",t)},expression:"addRoleForm.roleName"}})],1),r("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[r("el-input",{model:{value:e.addRoleForm.roleDesc,callback:function(t){e.$set(e.addRoleForm,"roleDesc",t)},expression:"addRoleForm.roleDesc"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addRole}},[e._v("确 定")])],1)],1)],1)},a=[],n=r("5a0f"),c={name:"RoleAdd",data(){return{addDialogVisible:!1,addRoleForm:{roleName:"",roleDesc:""},roleFormRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:10,message:"长度需要在2到10之间",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"},{min:3,max:20,message:"长度需要在3到20之间",trigger:"blur"}]}}},methods:{addRole(){this.$refs.addRoleFormRef.validate(e=>{e&&Object(n["b"])(this.addRoleForm).then(e=>{let t=e.data;if(201!==t.meta.status)return this.alertMessage("添加角色失败","error");this.alertMessage("添加角色成功","success"),this.addDialogVisible=!1,this.$emit("role-list")})})},addDialogClose(){this.$refs.addRoleFormRef.resetFields()}}},d=c,u=r("2877"),m=Object(u["a"])(d,i,a,!1,null,"b4b8e1a0",null),h=m.exports,f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"editDialog"},[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.showEditDialog(e.roleId)}}},[e._v("编辑")]),r("el-dialog",{attrs:{title:"修改用户",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editDialogClose}},[r("el-form",{ref:"editRoleFormRef",attrs:{model:e.editRoleForm,rules:e.roleFormRules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[r("el-input",{model:{value:e.editRoleForm.roleName,callback:function(t){e.$set(e.editRoleForm,"roleName",t)},expression:"editRoleForm.roleName"}})],1),r("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[r("el-input",{model:{value:e.editRoleForm.roleDesc,callback:function(t){e.$set(e.editRoleForm,"roleDesc",t)},expression:"editRoleForm.roleDesc"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.editRole}},[e._v("确 定")])],1)],1)],1)},b=[],g={name:"RoleEdit",props:{roleId:{type:Number,required:!0}},data(){return{editDialogVisible:!1,editRoleForm:{roleName:"",roleDesc:""},roleFormRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:10,message:"长度需要在2到10之间",trigger:"blur"}],roleDesc:[{required:!0,message:"请输入角色描述",trigger:"blur"},{min:3,max:20,message:"长度需要在3到20之间",trigger:"blur"}]}}},methods:{showEditDialog(e){this.editDialogVisible=!0,Object(n["e"])(e).then(e=>{let t=e.data;if(200!==t.meta.status)return this.alertMessage("获取角色信息失败","error");this.editRoleForm=t.data})},editDialogClose(){this.$refs.editRoleFormRef.resetFields()},editRole(){this.$refs.editRoleFormRef.validate(e=>{e&&Object(n["c"])(this.editRoleForm).then(e=>{let t=e.data;if(200!==t.meta.status)return this.alertMessage("修改失败","error");this.alertMessage("修改成功","success"),this.editDialogVisible=!1,this.$emit("role-list")})})}}},p=g,R=(r("c692"),Object(u["a"])(p,f,b,!1,null,"2cd935fd",null)),v=R.exports,y=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.removeRoleById(e.roleId)}}},[e._v("删除")])},D=[],_={name:"RoleRemove",props:{roleId:{type:Number,required:!0}},methods:{removeRoleById(e){this.$confirm("此操作将删除该角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Object(n["h"])(e).then(e=>{let t=e.data;if(200!==t.meta.status)return this.alertMessage("删除失败","error");this.alertMessage("删除成功","success"),this.$emit("role-list")})}).catch(()=>{this.alertMessage("已取消删除","info")})}}},w=_,F=Object(u["a"])(w,y,D,!1,null,"1ef4c51c",null),k=F.exports,x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"setRightDialog"},[r("el-button",{attrs:{type:"warning",icon:"el-icon-menu",size:"mini"},on:{click:function(t){return e.showSetRightDialog(e.role)}}},[e._v("分配权限")]),r("el-dialog",{attrs:{title:"分配权限",visible:e.setRightDialogVisible,width:"50%"},on:{"update:visible":function(t){e.setRightDialogVisible=t},close:e.rightDialogClose}},[r("el-tree",{ref:"treeRef",attrs:{data:e.rightsList,props:e.treeProps,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":e.defaultKeys}}),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.setRightDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.allotRights}},[e._v("确 定")])],1)],1)],1)},$=[],j={name:"RoleSetRight",props:{role:{type:Object,default(){return{}}}},data(){return{setRightDialogVisible:!1,rightsList:[],defaultKeys:[],treeProps:{label:"authName",children:"children"},roleId:""}},methods:{showSetRightDialog(e){this.roleId=e.id,Object(n["d"])("tree").then(t=>{let r=t.data;if(200!==r.meta.status)return this.alertMessage("获取权限数据失败","error");this.rightsList=r.data,this.getLeafKeys(e,this.defaultKeys),this.setRightDialogVisible=!0})},showSetRightDialog(e){this.roleId=e.id,Object(n["d"])("tree").then(t=>{let r=t.data;if(200!==r.meta.status)return this.alertMessage("获取权限数据失败","error");this.rightsList=r.data,this.getLeafKeys(e,this.defaultKeys),this.setRightDialogVisible=!0})},getLeafKeys(e,t){if(!e.children)return t.push([e.id]);e.children.forEach(e=>{this.getLeafKeys(e,t)})},rightDialogClose(){this.defaultKeys=[]},allotRights(){let e=[...this.$refs.treeRef.getCheckedKeys(),...this.$refs.treeRef.getHalfCheckedKeys()],t=e.join(",");Object(n["a"])(this.roleId,t).then(e=>{let t=e.data;if(200!==t.meta.status)return this.alertMessage("更新权限失败","error");this.alertMessage("更新权限成功","success"),this.setRightDialogVisible=!1,this.$emit("role-list")})}}},O=j,L=(r("6cd8"),Object(u["a"])(O,x,$,!1,null,"66e9c438",null)),N=L.exports,M=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-table",{attrs:{data:e.rolesList,border:"",stripe:""}},[r("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(e){return[r("role-table-rights-row",{attrs:{scope:e}})]}}])}),r("el-table-column",{attrs:{type:"index"}}),r("el-table-column",{attrs:{prop:"roleName",label:"角色名称"}}),r("el-table-column",{attrs:{prop:"roleDesc",label:"角色描述"}}),r("el-table-column",{attrs:{label:"操作",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("role-edit",{attrs:{"role-id":t.row.id},on:{"role-list":e.updateRoleList}}),r("role-remove",{attrs:{"role-id":t.row.id},on:{"role-list":e.updateRoleList}}),r("role-set-right",{attrs:{role:t.row},on:{"role-list":e.updateRoleList}})]}}])})],1)},V=[],C=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",e._l(e.scope.row.children,(function(t,l){return r("el-row",{key:t.id,class:["border-bottom",0===l?"border-top":"","vcenter"]},[r("el-col",{attrs:{span:5}},[r("el-tag",{attrs:{closable:""},on:{close:function(r){return e.removeRightById(e.scope.row,t.id)}}},[e._v(e._s(t.authName))]),r("i",{staticClass:"el-icon-caret-right"})],1),r("el-col",{attrs:{span:19}},e._l(t.children,(function(t,l){return r("el-row",{key:t.id,staticClass:"vcenter",class:{"border-top":0!==l}},[r("el-col",{attrs:{span:6}},[r("el-tag",{attrs:{closable:"",type:"success"},on:{close:function(r){return e.removeRightById(e.scope.row,t.id)}}},[e._v(e._s(t.authName)+" ")]),r("i",{staticClass:"el-icon-caret-right"})],1),r("el-col",{attrs:{span:18}},e._l(t.children,(function(t){return r("el-tag",{key:t.id,attrs:{closable:"",type:"warning"},on:{close:function(r){return e.removeRightById(e.scope.row,t.id)}}},[e._v(e._s(t.authName)+" ")])})),1)],1)})),1)],1)})),1)},I=[],E={name:"RoleTableRightsRow",props:{scope:{type:Object}},methods:{removeRightById(e,t){this.$confirm("此操作将删除该权限, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Object(n["g"])(e.id,t).then(t=>{let r=t.data;if(200!==r.meta.status)return this.alertMessage("删除失败","error");this.alertMessage("删除成功","success"),e.children=r.data})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})}}},B=E,K=(r("de2c"),Object(u["a"])(B,C,I,!1,null,"7f6db51f",null)),S=K.exports,T={name:"RoleTable",props:{rolesList:{type:Array,default(){return[]}}},components:{RoleEdit:v,RoleRemove:k,RoleSetRight:N,RoleTableRightsRow:S},methods:{updateRoleList(){this.$emit("role-list")}}},q=T,z=Object(u["a"])(q,M,V,!1,null,"7c2eea8b",null),A=z.exports,J={name:"Roles",components:{BreadcrumbNav:s["a"],RoleAdd:h,RoleEdit:v,RoleRemove:k,RoleSetRight:N,RoleTable:A},data(){return{rolesList:[]}},created(){this.getRolesList()},methods:{getRolesList(){Object(n["f"])().then(e=>{let t=e.data;if(200!==t.meta.status)return this.alertMessage("获取角色列表失败","error");this.rolesList=t.data})},updateRoleList(){this.getRolesList()}}},P=J,H=Object(u["a"])(P,l,o,!1,null,"e9c437b0",null);t["default"]=H.exports}}]);
//# sourceMappingURL=chunk-406b6444.d604f997.js.map